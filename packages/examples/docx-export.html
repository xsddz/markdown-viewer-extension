<!DOCTYPE html>
<!--
  markdown-viewer-sdk - DOCX Export Demo
  
  è¿è¡Œ: cd packages && npx serve . && open http://localhost:3000/examples/docx-export.html
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>markdown-viewer-sdk - DOCX Export Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 20px;
      background: #f5f5f5;
      max-width: 1000px;
      margin: 0 auto;
    }
    h1 { margin-bottom: 10px; color: #333; }
    .subtitle { color: #666; margin-bottom: 20px; }
    
    .panel {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      overflow: hidden;
    }
    .panel-header {
      background: #4a5568;
      color: white;
      padding: 12px 16px;
      font-weight: 600;
    }
    .panel-content {
      padding: 16px;
    }
    
    textarea {
      width: 100%;
      min-height: 300px;
      padding: 16px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
    }
    textarea:focus { outline: 2px solid #4a5568; }
    
    .buttons {
      display: flex;
      gap: 10px;
      margin-top: 16px;
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .btn-primary {
      background: #4a5568;
      color: white;
    }
    .btn-primary:hover { background: #2d3748; }
    .btn-primary:disabled {
      background: #a0aec0;
      cursor: not-allowed;
    }
    .btn-secondary {
      background: #e2e8f0;
      color: #4a5568;
    }
    .btn-secondary:hover { background: #cbd5e0; }
    
    .preview {
      background: #fafafa;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 16px;
      min-height: 200px;
      max-height: 400px;
      overflow-y: auto;
    }
    .preview h1, .preview h2, .preview h3 { margin: 1em 0 0.5em; }
    .preview h1:first-child { margin-top: 0; }
    .preview p { margin: 0.5em 0; }
    .preview code {
      background: #f0f0f0;
      padding: 2px 6px;
      border-radius: 4px;
    }
    .preview pre {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 12px;
      border-radius: 6px;
      overflow-x: auto;
    }
    .preview pre code { background: none; }
    .preview ul, .preview ol {
      margin: 0.5em 0;
      padding-left: 2em;
    }
    .preview table { border-collapse: collapse; margin: 1em 0; }
    .preview th, .preview td { border: 1px solid #ddd; padding: 8px 12px; }
    .preview th { background: #f5f5f5; }
    
    .status {
      margin-top: 20px;
      padding: 12px;
      border-radius: 6px;
      font-size: 14px;
    }
    .status.success { background: #e8f5e9; color: #2e7d32; }
    .status.error { background: #ffebee; color: #c62828; }
    .status.info { background: #e3f2fd; color: #1565c0; }
    
    .api-note {
      background: #fff3e0;
      border-left: 4px solid #ff9800;
      padding: 12px 16px;
      margin-bottom: 20px;
      font-size: 14px;
    }
    .api-note code {
      background: rgba(0,0,0,0.1);
      padding: 2px 6px;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <h1>DOCX Export Demo</h1>
  <p class="subtitle">ä½¿ç”¨ DocxExporter å°† Markdown å¯¼å‡ºä¸º Word æ–‡æ¡£</p>

  <div class="api-note">
    <strong>API è¯´æ˜ï¼š</strong>
    <code>await MarkdownViewer.exportToDocx(markdown, filename)</code><br>
    ä½¿ç”¨å†…ç½®é»˜è®¤ä¸»é¢˜ï¼Œæ”¯æŒæ‰€æœ‰ Markdown ç‰¹æ€§
  </div>

  <div class="panel">
    <div class="panel-header">Markdown è¾“å…¥</div>
    <div class="panel-content">
      <textarea id="input"># ç¤ºä¾‹æ–‡æ¡£

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ **markdown-viewer-sdk** ç”Ÿæˆçš„ Word æ–‡æ¡£ç¤ºä¾‹ã€‚

## åŠŸèƒ½ç‰¹æ€§

SDK æ”¯æŒä»¥ä¸‹ Markdown ç‰¹æ€§ï¼š

- **ç²—ä½“** å’Œ *æ–œä½“* æ–‡æœ¬
- `è¡Œå†…ä»£ç ` å’Œä»£ç å—
- æœ‰åºå’Œæ— åºåˆ—è¡¨
- è¡¨æ ¼å’Œå¼•ç”¨å—

## ä»£ç ç¤ºä¾‹

```javascript
import { DocxExporter } from 'markdown-viewer-sdk';

const exporter = new DocxExporter();
await exporter.exportToDocx(markdown, 'document.docx');
```

## æ•°æ®è¡¨æ ¼

| åŠŸèƒ½ | æ”¯æŒçŠ¶æ€ |
|------|----------|
| æ ‡é¢˜ | âœ… |
| åˆ—è¡¨ | âœ… |
| è¡¨æ ¼ | âœ… |
| ä»£ç  | âœ… |

> ğŸ’¡ æç¤ºï¼šå¯¼å‡ºçš„æ–‡æ¡£å¯ä»¥åœ¨ Microsoft Wordã€Google Docs æˆ–å…¶ä»–å…¼å®¹è½¯ä»¶ä¸­æ‰“å¼€ã€‚

---

*ç”± markdown-viewer-sdk å¯¼å‡º*</textarea>
      
      <div class="buttons">
        <button id="exportBtn" class="btn-primary" onclick="exportDocx()">
          ğŸ“„ å¯¼å‡ºä¸º DOCX
        </button>
        <button class="btn-secondary" onclick="previewHtml()">
          ğŸ‘ï¸ é¢„è§ˆ HTML
        </button>
      </div>
    </div>
  </div>

  <div class="panel">
    <div class="panel-header">HTML é¢„è§ˆ</div>
    <div class="panel-content">
      <div id="preview" class="preview">
        <span style="color: #888; font-style: italic;">ç‚¹å‡»"é¢„è§ˆ HTML"æŒ‰é’®æŸ¥çœ‹æ¸²æŸ“ç»“æœ</span>
      </div>
    </div>
  </div>

  <div id="status" class="status info">
    å‡†å¤‡å°±ç»ªï¼Œç­‰å¾…æ“ä½œ...
  </div>

  <script src="../dist/index.iife.js"></script>
  <script>
    const input = document.getElementById('input');
    const preview = document.getElementById('preview');
    const status = document.getElementById('status');
    const exportBtn = document.getElementById('exportBtn');

    let currentHtml = '';

    // Check library loaded
    if (typeof MarkdownViewer === 'undefined') {
      status.innerHTML = 'âŒ åŠ è½½å¤±è´¥ - è¯·ä½¿ç”¨ HTTP æœåŠ¡å™¨<br><code>cd packages && npx serve .</code>';
      status.className = 'status error';
      exportBtn.disabled = true;
    } else {
      status.textContent = `âœ… SDK å·²åŠ è½½ (v${MarkdownViewer.VERSION})`;
      status.className = 'status success';
    }

    async function previewHtml() {
      try {
        const markdown = input.value;
        const startTime = performance.now();
        
        currentHtml = await MarkdownViewer.toHtml(markdown);
        
        const endTime = performance.now();
        preview.innerHTML = currentHtml;
        status.textContent = `âœ… HTML æ¸²æŸ“å®Œæˆ (${(endTime - startTime).toFixed(1)}ms)`;
        status.className = 'status success';
      } catch (error) {
        preview.innerHTML = `<span style="color: red;">é”™è¯¯: ${error.message}</span>`;
        status.textContent = `âŒ æ¸²æŸ“å¤±è´¥: ${error.message}`;
        status.className = 'status error';
      }
    }

    async function exportDocx() {
      exportBtn.disabled = true;
      exportBtn.textContent = 'â³ å¯¼å‡ºä¸­...';
      
      try {
        const markdown = input.value;
        const startTime = performance.now();
        
        // ä½¿ç”¨ç®€åŒ–çš„å¯¼å‡º APIï¼ˆè‡ªåŠ¨ä½¿ç”¨å†…ç½®é»˜è®¤ä¸»é¢˜ï¼‰
        await MarkdownViewer.exportToDocx(markdown, 'markdown-export.docx', (current, total) => {
          status.textContent = `â³ å¯¼å‡ºä¸­... ${Math.round(current / total * 100)}%`;
        });
        
        const endTime = performance.now();
        status.textContent = `âœ… DOCX å¯¼å‡ºæˆåŠŸï¼(${(endTime - startTime).toFixed(1)}ms) - æ–‡ä»¶å·²ä¸‹è½½`;
        status.className = 'status success';
      } catch (error) {
        status.textContent = `âŒ å¯¼å‡ºå¤±è´¥: ${error.message}`;
        status.className = 'status error';
        console.error('Export error:', error);
      } finally {
        exportBtn.disabled = false;
        exportBtn.textContent = 'ğŸ“„ å¯¼å‡ºä¸º DOCX';
      }
    }

    // Auto preview on load
    previewHtml();
  </script>
</body>
</html>
