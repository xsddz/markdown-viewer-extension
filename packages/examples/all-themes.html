<!DOCTYPE html>
<!--
  markdown-viewer-sdk - Themes Demo
  
  展示如何使用 SDK 内置主题
  包含 29 个内置主题预览
  
  运行: cd packages && npx serve . && open http://localhost:3000/examples/all-themes.html
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>markdown-viewer-sdk - Themes Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      display: flex;
      height: 100vh;
    }
    
    /* Sidebar */
    .sidebar {
      width: 280px;
      background: #1a1a2e;
      color: white;
      padding: 20px;
      overflow-y: auto;
      flex-shrink: 0;
    }
    .sidebar h1 { font-size: 18px; margin-bottom: 8px; }
    .sidebar .subtitle { font-size: 12px; color: #888; margin-bottom: 20px; }
    
    .category { margin-bottom: 20px; }
    .category-title {
      font-size: 11px;
      text-transform: uppercase;
      color: #666;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    .theme-list { list-style: none; }
    .theme-item {
      padding: 10px 12px;
      margin-bottom: 4px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
    }
    .theme-item:hover { background: rgba(255,255,255,0.1); }
    .theme-item.active { background: #4a5568; }
    .theme-item .theme-desc {
      font-size: 11px;
      color: #888;
      margin-top: 2px;
    }
    
    /* Main Content */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .toolbar {
      padding: 12px 20px;
      background: #f5f5f5;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .current-theme {
      font-weight: 600;
      color: #333;
    }
    .theme-info {
      font-size: 12px;
      color: #666;
    }
    
    /* Preview */
    .preview-wrapper {
      flex: 1;
      overflow-y: auto;
      padding: 40px;
      background: #fafafa;
    }
    
    #markdown-content {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
      border-radius: 8px;
      padding: 40px 60px;
    }
    
    /* Theme Base Styles - will be enhanced by SDK themes */
    #markdown-content h1 { margin: 0 0 0.5em; }
    #markdown-content h2 { margin: 1.5em 0 0.5em; }
    #markdown-content h3 { margin: 1.2em 0 0.4em; }
    #markdown-content p { margin: 0.8em 0; line-height: 1.6; }
    #markdown-content ul, #markdown-content ol { margin: 0.8em 0; padding-left: 2em; }
    #markdown-content li { margin: 0.4em 0; }
    #markdown-content a { text-decoration: none; }
    #markdown-content a:hover { text-decoration: underline; }
    
    /* Loading */
    .loading { text-align: center; padding: 40px; color: #666; }
    .error { color: #dc2626; }
  </style>
</head>
<body>
  <aside class="sidebar" id="sidebar">
    <h1>主题预览</h1>
    <p class="subtitle">SDK 内置主题</p>
    <div id="theme-categories">
      <p class="loading">加载中...</p>
    </div>
  </aside>

  <main class="main">
    <div class="toolbar">
      <span class="current-theme" id="current-theme">加载中...</span>
      <span class="theme-info">
        SDK <span id="version">-</span> | 
        使用 <code>themes.apply('id')</code> 应用主题
      </span>
    </div>
    
    <div class="preview-wrapper">
      <div id="markdown-content">
        <p class="loading">加载中...</p>
      </div>
    </div>
  </main>

  <script src="../dist/index.iife.js"></script>
  <script>
    // Sample markdown
    var sampleMarkdown = [
      '# 主题示例 Theme Example',
      '',
      '这是一个展示主题效果的示例文档。',
      '',
      '## 文字样式 Text Styles',
      '',
      '这是一段普通的正文内容。包含 **粗体**、*斜体* 和 `行内代码` 等样式。',
      '',
      '这里有一个 [链接示例](https://example.com)。',
      '',
      '## 代码块 Code Block',
      '',
      '```javascript',
      'function greet(name) {',
      '  console.log("Hello, " + name + "!");',
      '  return true;',
      '}',
      '```',
      '',
      '## 列表 Lists',
      '',
      '- 第一项',
      '- 第二项',
      '  - 子项 A',
      '  - 子项 B',
      '- 第三项',
      '',
      '1. 有序项一',
      '2. 有序项二',
      '3. 有序项三',
      '',
      '## 引用 Blockquote',
      '',
      '> 这是一段引用文字。',
      '> 用来展示引用块的样式效果。',
      '',
      '## 表格 Table',
      '',
      '| 功能 | 描述 | 状态 |',
      '|------|------|------|',
      '| 主题系统 | 29 个内置主题 | ✅ |',
      '| 图表渲染 | Mermaid/Vega | ✅ |',
      '| DOCX 导出 | Word 文档 | ✅ |',
      '',
      '---',
      '',
      '*由 markdown-viewer-sdk 渲染*'
    ].join('\n');

    var content = document.getElementById('markdown-content');
    var categoriesEl = document.getElementById('theme-categories');
    var currentThemeEl = document.getElementById('current-theme');
    var versionEl = document.getElementById('version');

    var currentThemeId = 'default';

    // Category display names
    var categoryNames = {
      'classic': '经典文档 Classic',
      'reading': '书籍阅读 Reading',
      'modern': '现代科技 Modern',
      'creative': '创意设计 Creative',
      'chinese': '中文优化 Chinese',
      'nature': '自然主题 Nature',
      'playful': '趣味童趣 Playful'
    };

    // Markdown content - fetched from IMPLEMENTATION.md
    var markdownContent = '';

    // Initialize
    async function init() {
      if (typeof MarkdownViewer === 'undefined') {
        content.innerHTML = '<p class="error">SDK 加载失败</p>';
        return;
      }

      versionEl.textContent = MarkdownViewer.VERSION;
      
      // Fetch IMPLEMENTATION.md as demo content
      try {
        var response = await fetch('../IMPLEMENTATION.md');
        if (response.ok) {
          markdownContent = await response.text();
        } else {
          markdownContent = sampleMarkdown; // Fallback
        }
      } catch (e) {
        markdownContent = sampleMarkdown; // Fallback
      }
      
      // Render markdown
      var html = await MarkdownViewer.toHtml(markdownContent);
      content.innerHTML = html;
      
      // Build theme sidebar using SDK themes API
      buildThemeSidebar();
      
      // Apply default theme
      applyTheme('default');
    }

    function buildThemeSidebar() {
      var themes = MarkdownViewer.themes;
      var categories = themes.listByCategory();
      
      var html = '';
      for (var i = 0; i < categories.length; i++) {
        var cat = categories[i];
        var displayName = categoryNames[cat.id] || cat.name;
        html += '<div class="category">';
        html += '<div class="category-title">' + displayName + '</div>';
        html += '<ul class="theme-list">';
        
        for (var j = 0; j < cat.themes.length; j++) {
          var theme = cat.themes[j];
          var isActive = theme.id === 'default' ? ' active' : '';
          var desc = theme.description || theme.name_en || '';
          html += '<li class="theme-item' + isActive + '" data-theme="' + theme.id + '">';
          html += theme.name;
          html += '<div class="theme-desc">' + desc + '</div>';
          html += '</li>';
        }
        
        html += '</ul></div>';
      }
      
      categoriesEl.innerHTML = html;
      
      // Add click handlers
      document.querySelectorAll('.theme-item').forEach(function(item) {
        item.addEventListener('click', function() {
          applyTheme(item.dataset.theme);
        });
      });
    }

    function applyTheme(themeId) {
      var themes = MarkdownViewer.themes;
      
      try {
        // Use SDK themes API to apply theme
        themes.apply(themeId);
        currentThemeId = themeId;
        
        // Update UI
        var themeInfo = themes.get(themeId);
        if (themeInfo) {
          currentThemeEl.textContent = themeInfo.name + ' (' + (themeInfo.name_en || themeId) + ')';
        } else {
          currentThemeEl.textContent = themeId;
        }
        
        // Update active state
        document.querySelectorAll('.theme-item').forEach(function(item) {
          if (item.dataset.theme === themeId) {
            item.classList.add('active');
          } else {
            item.classList.remove('active');
          }
        });
      } catch (e) {
        console.error('Failed to apply theme:', e);
        currentThemeEl.textContent = '错误: ' + e.message;
      }
    }

    init();
  </script>
</body>
</html>
